{block #javascripts}
	<script src="{$basePath}/js/jquery.nette.js"></script>
	<script src="{$basePath}/js/jquery.ajaxform.js"></script>
	<script>
		function ancovicky() {
			console.info('booom');
		}

		$(function() {
			$('form[id*="commentForm"]').find('input[type="submit"]').live('click', (function(e) {
				e.preventDefault();

				$frm = $(this);
				$errs = $('form[id*="commentForm"]').find('span.error');

				if ($errs.length) {
					$errs.fadeOut(800, function() {
						$frm.ajaxSubmit();
					});
				} else {
					$frm.ajaxSubmit();
				}
			}));
		});
	</script>
{/block}


{block #content}

<div id="posts">

	<div class="post single">
		<h2 class="entry-title"><a href="{plink Default:post 'slug'=>$post->getSlug()}">{$post->getHeadline()}</a></h2>
		<p class="entry-date">{$post->getCreated()->format('M j, Y')}</p>
		<p class="comments-link"><a href="{plink Default:post 'slug'=>$post->getSlug()}#comments">{=count($comments)}</a></p>

		<div class="entry-content">
			{!$post->getText()}
		</div><!-- .entry-content -->

		<p class="tag-links">
			<span>tagy: </span>
			{foreach $post->getTags() as $tag}
				<a href="{plink Default:tag 'tag'=>$tag->getName()}">{$tag->getName()}</a>
				{if !$iterator->isLast()}|{/if}
			{/foreach}
		</p>
	</div><!-- .post -->





	<div id="comments">
		<h3>Comments</h3>

		<p class="comments-link">{=count($comments)}</p>

		{if !empty($comments)}

			<ol id="commentlist">
				{foreach $comments as $comment}
					<li id="comment-{$comment->getId()}">
						<div class="commentHead">
							<a class="commentPermalink" href="#comment-{$comment->getId()}">#{$iterator->getCounter()}</a>
							<div class="commentAuthor">
								{if $comment->getAuthorUrl()}
									<a href="http://{$comment->getAuthorUrl()}">{$comment->getAuthor()}</a>
								{else}
									{$comment->getAuthor()}
								{/if}
							</div>
							<p class="commentDate">{$comment->getCreated()->format('M j, Y, H:i')}</p>
						</div>

						<div class="commentBody">
							{!$comment->getText()}
						</div>
					</li><!-- comment -->
				{/foreach}
			</ol><!-- #commentlist -->

		{else}

			<p>No comments yet</p>

		{/if}


		<h3>Leave a Reply</h3>


		{snippet:pokus}
			{control commentForm begin}

				{var form => $control['commentForm']}

				{if $form->hasErrors()}
					<h3>Form contains errors</h3>
				{/if}

				{*if is_user_logged_in()*}

						<!--
						<p>Logged in as <a href="profile.php">{*$user_identity*}</a>.
						<a href="logout" title="Log out of this account">Log out &raquo;</a></p>
						-->

				{*else*}

					<p>
						{$form['author']->control}
						{$form['author']->label}
						<span class="error" n:foreach="$form['author']->errors as $error">{$error}</span>
					</p>

					<p>
						{$form['authorEmail']->control}
						{$form['authorEmail']->label}
						<span class="error" n:foreach="$form['authorEmail']->errors as $error">{$error}</span>
					</p>

					<p>
						{$form['authorUrl']->control}
						{$form['authorUrl']->label}
						<span class="error" n:foreach="$form['authorUrl']->errors as $error">{$error}</span>
					</p>

				{*/if*}

				<p>
					{$form['comment']->control}
					{$form['comment']->label}
					<span class="error" n:foreach="$form['comment']->errors as $error">{$error}</span>
				</p>

				<p>{$form['send']->control}</p>

			{control commentForm end}
		{/snippet}

	</div><!-- #comments -->

</div><!-- #posts -->
